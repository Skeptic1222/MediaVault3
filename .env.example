# MediaVault Production Configuration Template
# SECURITY: Copy this file to .env and configure with secure values
# NEVER commit .env to version control

# =============================================================================
# ENVIRONMENT
# =============================================================================
NODE_ENV=production
PORT=3001
BASE_PATH=/mediavault

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection settings
DB_TYPE=postgresql
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mediavault
DB_USER=mediavault_user

# SECURITY: Generate secure password with:
# node -e "console.log(require('crypto').randomBytes(24).toString('base64'))"
DB_PASSWORD=CHANGE_THIS_SECURE_PASSWORD

# Full connection string
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# =============================================================================
# SECURITY KEYS (CRITICAL - MUST BE UNIQUE PER DEPLOYMENT)
# =============================================================================
# Generate all keys with: node scripts/generate-credentials.js

# Session encryption key (32 bytes, base64)
SESSION_SECRET=GENERATE_WITH_SCRIPT

# Filesystem encryption master key (32 bytes, hex)
FILESYSTEM_MASTER_KEY=GENERATE_WITH_SCRIPT

# JWT signing secret (32 bytes, base64)
JWT_SECRET=GENERATE_WITH_SCRIPT

# =============================================================================
# AUTHENTICATION
# =============================================================================
# CRITICAL: These MUST be false in production
AUTH_DISABLED=false
SKIP_AUTH=false
NO_AUTH=false

# Google OAuth 2.0 Configuration
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-app-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-client-secret

# OAuth callback URL (production)
APP_URL=https://ay-i-t.com

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================
# CRITICAL: Must be true in production (HTTPS only)
SECURE_COOKIES=true

# Trust proxy headers (required for IIS reverse proxy)
TRUST_PROXY=true

# Session time-to-live (24 hours)
SESSION_TTL=86400000

# =============================================================================
# FILE STORAGE
# =============================================================================
UPLOAD_DIR=./uploads
ENCRYPTED_MEDIA_DIR=./encrypted_media
TEMP_DIR=./temp
THUMBNAIL_DIR=./thumbnails
LOG_DIR=./logs

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Rate limiting (15 minutes window, 100 requests)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# File upload limits
MAX_FILE_SIZE=104857600  # 100MB in bytes (production limit)
MAX_FIELD_SIZE=1048576   # 1MB field size

# Allowed MIME types (enforced by server)
ALLOWED_FILE_TYPES=image/*,video/*,audio/*,application/pdf

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/csp-report

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Allowed origins (comma-separated)
CORS_ORIGIN=https://ay-i-t.com
CORS_CREDENTIALS=true

# =============================================================================
# WINDOWS CREDENTIAL STORE (OPTIONAL - RECOMMENDED FOR PRODUCTION)
# =============================================================================
# Use Windows Credential Manager for sensitive data
USE_WINDOWS_CREDENTIAL_STORE=false
CREDENTIAL_TARGET=MediaVault_Production

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
LOG_LEVEL=info

# Sentry error tracking (optional)
SENTRY_DSN=

# Application Insights (optional)
APPINSIGHTS_INSTRUMENTATIONKEY=

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
#
# ✅ All GENERATE_WITH_SCRIPT values replaced with actual secure keys
# ✅ AUTH_DISABLED=false, SKIP_AUTH=false, NO_AUTH=false
# ✅ SECURE_COOKIES=true (HTTPS only)
# ✅ Google OAuth configured with production callback URL
# ✅ DB_PASSWORD changed to secure value
# ✅ CORS_ORIGIN set to your production domain
# ✅ CSP_ENABLED=true
# ✅ Windows Credential Store enabled (USE_WINDOWS_CREDENTIAL_STORE=true)
# ✅ File permissions set to 600 on .env file
# ✅ .env added to .gitignore
#
# Generate credentials:
#   node scripts/generate-credentials.js
#
# Verify security:
#   npm run security:validate
#
# Setup Windows Credential Store:
#   npm run security:setup
#
